---
ParentTask:
  - "[[graphs]]"
---

# LeetCode
[207. Course Schedule](https://leetcode.com/problems/course-schedule/)

# Concept
- **整理一個雙向的 mapping**
	- Course -> 需要先修哪些課程的 List (course -> prerequisite courses)
	- Course -> 哪些課程需要先修這門課的 List (prerequisit course -> requiring course)
- **從『不用 prerequisit 的課程開始 enroll』，並且在『enroll 後更新需要這門課當做 pre-requisite 的課程 -> 把 enrolled course 從 pre-requisite list 拿掉』**
# Answer：BFS
## V1： 記錄每堂課剩下的 Prerequisite，沒有 Prerequisite 的課程可以 enroll
```Cpp
class Solution {
public:
    bool canFinish(int numCourses, vector<vector<int>>& prerequisites) {
        // prerequisites map
        /*
        {
            Course 0 ->[1, 3, 4, 6]
            Course 1 ->[2, 3, 5, 7]
            Course 2 ->[4, 7]
            Course 3 ->[4, 8]
            Course 4 ->[5]
            Course 5 ->[6]
            Course 6 ->[x]
            Course 7 ->[8]
            Course 8 ->[6]
        }
        */
        vector<unordered_set<int>> courseToPrequisitList(numCourses);
        vector<vector<int>> preqToRequiringCourseList(numCourses);
        for(auto &preq : prerequisites) {
            courseToPrequisitList[ preq[0] ].insert( preq[1] );
            preqToRequiringCourseList[ preq[1] ].push_back( preq[0] );
        }

        vector<int> enrollCourseSeq(numCourses);
        int enrolledNum = 0;

        // firstly enroll all courses need no prerequisits
        for(int i = 0; i < courseToPrequisitList.size(); i++) {
            if(courseToPrequisitList[i].size() != 0) continue;
            enrollCourseSeq[ enrolledNum++ ] = i;
        }

        // update the course requirement & enroll new courses without prerequisits
        for(int i = 0; i < enrolledNum; i++) {
            // pop one course needs no prequisit to enroll
            int course = enrollCourseSeq[i];

            // update course conditions
            for(auto reqCourse : preqToRequiringCourseList[course]) {
                // take out the prerequisit of the enrolled course
                courseToPrequisitList[reqCourse].erase( course );

                // if all the prerequisits of the course are all enrolled -> add to pending
                if(courseToPrequisitList[reqCourse].size() == 0) {
                    enrollCourseSeq[ enrolledNum++ ] = reqCourse;
                }
            }
        }

        return (enrolledNum == numCourses);
    }
};
```

## V2： 記錄每堂課剩下的 Prerequisite Cnt，Prerequisite Cnt = 0 的課程可以 enroll
```Cpp
class Solution {
public:
    bool canFinish(int numCourses, vector<vector<int>>& prerequisites) {
        // prerequisites map
        /*
        {
            Course 0 ->[1, 3, 4, 6]
            Course 1 ->[2, 3, 5, 7]
            Course 2 ->[4, 7]
            Course 3 ->[4, 8]
            Course 4 ->[5]
            Course 5 ->[6]
            Course 6 ->[x]
            Course 7 ->[8]
            Course 8 ->[6]
        }
        */
        vector<int> courseToPrequisitNum(numCourses);
        vector<vector<int>> preqToRequiringCourseList(numCourses);
        for(auto &preq : prerequisites) {
            courseToPrequisitNum[ preq[0] ]++;
            preqToRequiringCourseList[ preq[1] ].push_back( preq[0] );
        }

        vector<int> enrollCourseSeq(numCourses);
        int enrolledNum = 0;

        // firstly enroll all courses need no prerequisits
        for(int i = 0; i < courseToPrequisitNum.size(); i++) {
            if(courseToPrequisitNum[i] != 0) continue;
            enrollCourseSeq[ enrolledNum++ ] = i;
        }

        // update the course requirement & enroll new courses without prerequisits
        for(int i = 0; i < enrolledNum; i++) {
            // pop one course needs no prequisit to enroll
            int course = enrollCourseSeq[i];

            // update course conditions
            for(auto reqCourse : preqToRequiringCourseList[course]) {
                // take out the prerequisit of the enrolled course
                courseToPrequisitNum[reqCourse]--;

                // if all the prerequisits of the course are all enrolled -> add to pending
                if(courseToPrequisitNum[reqCourse] == 0) {
                    enrollCourseSeq[ enrolledNum++ ] = reqCourse;
                }
            }
        }

        return (enrolledNum == numCourses);
    }
};
```